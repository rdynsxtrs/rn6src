commit bff38efe8c110469c5080d387bec62a6ca15b1a5
Author: obiwac <obiwac@gmail.com>
Date:   Fri Jul 22 22:41:10 2022 +0200

    libarchive: Handle a `calloc` returning NULL (fixes #1754)

Index: libarchive-3.3.3/libarchive/archive_write.c
===================================================================
--- libarchive-3.3.3.orig/libarchive/archive_write.c	2023-01-29 18:47:46.869184629 +0100
+++ libarchive-3.3.3/libarchive/archive_write.c	2023-01-29 18:47:46.865184635 +0100
@@ -211,6 +211,10 @@
 	struct archive_write_filter *f;
 
 	f = calloc(1, sizeof(*f));
+
+	if (f == NULL)
+		return (NULL);
+
 	f->archive = _a;
 	if (a->filter_first == NULL)
 		a->filter_first = f;
@@ -473,6 +477,10 @@
 	a->client_data = client_data;
 
 	client_filter = __archive_write_allocate_filter(_a);
+
+	if (client_filter == NULL)
+		return (ARCHIVE_FATAL);
+
 	client_filter->open = archive_write_client_open;
 	client_filter->write = archive_write_client_write;
 	client_filter->close = archive_write_client_close;
